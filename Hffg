-- Fly Script (LocalScript)



local HENG = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local MainWindow = HENG:CreateWindow({
	Name = "Border[WAR] បាញ់ឆ្កែសៀម by.2BK2",
	LoadingTitle = "welcome TO 2BK2",
	LoadingSubtitle = "BK",
	ConfigurationSaving = {
	   Enabled = false,
	   FolderName = nil, -- Create a custom folder for your hub/game
	   FileName = "BK Hub"
	},
	Discord = {
	   Enabled = false,
	   Invite = "", -- The Discord invite code, do not include discord.gg/. E.g. discord.gg/ABCD would be ABCD.
	   RememberJoins = true -- Set this to false to make them join the discord every time they load it up
	},
	KeySystem = true, -- Set this to true to use our key system
	KeySettings = {
	   Title = "BK Hub",
	   Subtitle = "Key System",
	   Note = "Key = ២០០០៛ អាចប្រើនបានច្រើនអ្នក",
	   FileName = "SiriusKey",
	   SaveKey = true,
	   GrabKeyFromSite = true, -- If this is true, set Key below to the RAW site you would like Rayfield to get the key from
	   Key = "2BK_236432"
	}
 })
 local MainTab = MainWindow:CreateTab("បាញ់គ្នារ") -- Title, Image

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local character, humanoid, hrp

local flying = false
local flySpeed = 50
local vertical = 0

local bv, bg

-- Setup character (handles respawn)
local function setupCharacter(char)
	character = char
	humanoid = char:WaitForChild("Humanoid")
	hrp = char:WaitForChild("HumanoidRootPart")

	bv = Instance.new("BodyVelocity")
	bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)

	bg = Instance.new("BodyGyro")
	bg.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
	bg.P = 1e4
end

setupCharacter(player.Character or player.CharacterAdded:Wait())
player.CharacterAdded:Connect(setupCharacter)

-- START FLY
function startFly()
	if flying or not hrp then return end
	flying = true

	humanoid.PlatformStand = true
	bv.Parent = hrp
	bg.Parent = hrp
end

-- STOP FLY
function stopFly()
	if not flying then return end
	flying = false

	humanoid.PlatformStand = false
	if bv then bv.Parent = nil end
	if bg then bg.Parent = nil end
	vertical = 0
end

-- PC UP / DOWN CONTROLS
UserInputService.InputBegan:Connect(function(input, gpe)
	if gpe then return end
	if input.KeyCode == Enum.KeyCode.E then
		vertical = 1
	elseif input.KeyCode == Enum.KeyCode.Q then
		vertical = -1
	end
end)

UserInputService.InputEnded:Connect(function(input)
	if input.KeyCode == Enum.KeyCode.E or input.KeyCode == Enum.KeyCode.Q then
		vertical = 0
	end
end)

-- Fly movement (PC + Mobile)
RunService.RenderStepped:Connect(function()
	if flying and hrp then
		local cam = workspace.CurrentCamera
		bg.CFrame = cam.CFrame

		local moveDir = humanoid.MoveDirection
		bv.Velocity =
			(cam.CFrame.RightVector * moveDir.X +
			cam.CFrame.LookVector * -moveDir.Z +
			Vector3.new(0, vertical, 0)) * flySpeed
	end
end)

local Toggle = MainTab:CreateToggle({
	Name = "Fly",
	CurrentValue = false,
	Flag = "fly",
	Callback = function(Value)
		if Value then
			startFly()
		else
			stopFly()
		end
	end,
})


